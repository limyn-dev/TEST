@ECHO off

Set DIR_APP=C:\ProgramData\TP_181201

@ECHO ------------------------------------------------------------------------------
@ECHO 1 - Set installation log path
@ECHO ------------------------------------------------------------------------------
MD "%~dp0LOG"

@ECHO ------------------------------------------------------------------------------
@ECHO 2 - Install Node.Js
@ECHO ------------------------------------------------------------------------------
msiexec /QB /I "%~dp0Sources\node-v10.14.1-x64.msi" /Lv "%~dp0LOG\NodeJs_Install.log"
CD "C:\Program Files\nodejs"

@ECHO ------------------------------------------------------------------------------
@ECHO 3 - Import module request.
@ECHO ------------------------------------------------------------------------------
cmd.exe /c npm install request

@ECHO ------------------------------------------------------------------------------
@ECHO 4 - Import module express.
@ECHO ------------------------------------------------------------------------------
cmd.exe /c npm install express

@ECHO ------------------------------------------------------------------------------
@ECHO 5 - Set application directory.
@ECHO ------------------------------------------------------------------------------
MD %DIR_APP%
robocopy "%~dp0Sources\APP" "%DIR_APP%" /MIR > "%~dp0LOG\APP.log"

@ECHO ------------------------------------------------------------------------------
@ECHO "END OF PROCESS."
@ECHO ------------------------------------------------------------------------------
PAUSE
